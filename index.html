<!DOCTYPE html>
<html lang="ka">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Tbilisi Transport Pro</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        :root { --primary: #5d5fef; --bg: #f4f7ff; --text: #2d3142; }
        * { box-sizing: border-box; font-family: 'Segoe UI', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { margin: 0; background: var(--bg); height: 100vh; display: flex; flex-direction: column; overflow: hidden; }
        
        /* Header */
        .header { background: white; padding: 15px 20px; border-radius: 0 0 30px 30px; box-shadow: 0 4px 20px rgba(0,0,0,0.05); z-index: 1000; }
        .lang-btns { display: flex; gap: 8px; margin-bottom: 12px; }
        .l-btn { border: none; background: #eee; padding: 6px 12px; border-radius: 8px; font-weight: bold; font-size: 12px; }
        .l-btn.active { background: var(--primary); color: white; }
        .top-info { display: flex; justify-content: space-between; align-items: center; }
        .top-info h1 { margin: 0; font-size: 20px; color: var(--text); }
        .status-dot { width: 10px; height: 10px; background: #10b981; border-radius: 50%; display: inline-block; margin-right: 5px; box-shadow: 0 0 8px #10b981; }

        /* Map */
        #map { flex: 1; width: 100%; z-index: 1; }

        /* Bottom Panel */
        .panel { background: white; height: 45%; border-radius: 35px 35px 0 0; padding: 20px; overflow-y: auto; z-index: 1000; box-shadow: 0 -5px 20px rgba(0,0,0,0.05); }
        .p-title { font-size: 18px; font-weight: bold; margin-bottom: 15px; display: block; }
        
        /* Bus Card */
        .card { background: #fff; border: 1px solid #f0f2f8; padding: 15px; border-radius: 20px; display: flex; align-items: center; margin-bottom: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.02); }
        .b-nr { width: 45px; height: 45px; border-radius: 12px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 18px; margin-right: 15px; }
        .b-info { flex: 1; }
        .b-info b { font-size: 15px; display: block; color: var(--text); }
        .b-info span { font-size: 13px; color: #9196b2; }
        .star { color: #ffcc00; font-size: 20px; margin-left: 10px; }
    </style>
</head>
<body onload="autoLocate()">

<div class="header">
    <div class="lang-btns">
        <button class="l-btn active" onclick="setL('ka', this)">GE</button>
        <button class="l-btn" onclick="setL('en', this)">EN</button>
        <button class="l-btn" onclick="setL('ru', this)">RU</button>
    </div>
    <div class="top-info">
        <div>
            <h1 id="t-title">თბილისის ტრანსპორტი</h1>
            <span style="font-size:12px; color:#9196b2;"><span class="status-dot"></span> <span id="t-live">Live: რეალური დრო</span></span>
        </div>
        <div id="loading-gps" style="font-size: 12px; color: var(--primary); font-weight: bold;">GPS...</div>
    </div>
</div>

<div id="map"></div>

<div class="panel">
    <span class="p-title" id="t-routes">მარშრუტები</span>
    <div id="list">
        <p style="text-align:center; color:#ccc; padding-top:20px;" id="t-wait">ვეძებ თქვენს ლოკაციას...</p>
    </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
    const lang = {
        ka: { title: "თბილისის ტრანსპორტი", live: "Live: რეალური დრო", routes: "მარშრუტები", wait: "ვეძებ თქვენს ლოკაციას...", min: "წთ" },
        en: { title: "Tbilisi Transport", live: "Live: Real-time", routes: "Routes", wait: "Locating you...", min: "min" },
        ru: { title: "Тбилисский Транспорт", live: "Live: В реальном времени", routes: "Маршруты", wait: "Поиск локации...", min: "мин" }
    };

    let cur = 'ka';
    let map = L.map('map', { zoomControl: false }).setView([41.7151, 44.7870], 13);
    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png').addTo(map);

    function setL(l, btn) {
        cur = l;
        document.getElementById('t-title').innerText = lang[l].title;
        document.getElementById('t-live').innerText = lang[l].live;
        document.getElementById('t-routes').innerText = lang[l].routes;
        document.getElementById('t-wait').innerText = lang[l].wait;
        document.querySelectorAll('.l-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        render();
    }

    // ავტომატური ლოკაცია საიტის გახსნისას
    function autoLocate() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(pos => {
                const { latitude, longitude } = pos.coords;
                document.getElementById('loading-gps').style.display = 'none';
                map.flyTo([latitude, longitude], 15);
                L.circleMarker([latitude, longitude], {radius: 8, color: '#fff', fillColor: '#5d5fef', fillOpacity: 1, weight: 3}).addTo(map);
                render();
            }, () => {
                document.getElementById('t-wait').innerText = "გთხოვთ, დაუშვათ GPS წვდომა ბრაუზერში";
            }, { enableHighAccuracy: true });
        }
    }

    function render() {
        const list = document.getElementById('list');
        list.innerHTML = '';
        const data = [
            { nr: '337', from: 'Samgori', to: 'Airport', time: 5, col: '#3b82f6' },
            { nr: '314', from: 'Dighomi', to: 'Center', time: 12, col: '#10b981' },
            { nr: '301', from: 'Isani', to: 'Politkovskaya', time: 2, col: '#f59e0b' }
        ];
        data.forEach(b => {
            list.innerHTML += `
                <div class="card">
                    <div class="b-nr" style="background:${b.col}">${b.nr}</div>
                    <div class="b-info">
                        <b>${b.from} - ${b.to}</b>
                        <span>~${b.time} ${lang[cur].min} • რეალურ დროში</span>
                    </div>
                    <div class="star">★</div>
                </div>`;
        });
    }
</script>
</body>
</html>




